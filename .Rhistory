theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Comeback %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.4)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Comeback %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.38)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Comeback %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Comeback %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.35)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Comeback %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.36)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Comeback %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Comeback %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "LOSE %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Lose %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Lose %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank()) %>%
save.image("points_allowed.png")
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Lose %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank()) %>%
ggsave("points_allowed.png")
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Lose %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank()) +
ggsave("points_allowed.png")
points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Lose %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank()) %>%
ggsave(file = "points_allowed.png")
plot <- points_conceded %>%
ungroup() %>%
mutate(ptsScored_team = ifelse(ptsScored_team >=3, "3+", as.character(ptsScored_team))) %>%
group_by(ptsScored_team) %>%
summarise(n = sum(n), wins = sum(wins)) %>%
mutate(win_pct = wins/n) %>%
mutate(lose_pct = 1 - win_pct) %>%
mutate(fill = ifelse(ptsScored_team == "3+", "#00471B", "#EEE1C6")) %>%
ggplot(aes(x = ptsScored_team, y = lose_pct, fill = fill)) + #color related to Y
geom_bar(stat = "identity") +
scale_fill_identity(guide = "legend") +
geom_text(aes(label = scales::percent(lose_pct, 1)), vjust = -0.5) +
scale_y_continuous(labels = percent, expand = c(0,0), limits = c(0, 0.37)) +
labs(x = "Points Allowed in Defensive Possession (Up 3, shot clock off)",
y = "Lose %",
title = "Teams LOSE 35% of the time when they allow 3+ points",
subtitle = "Points aren't created equal in the final seconds") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "italic", hjust = 0.5),
axis.text.y = element_text(face = "bold"),
panel.background = element_blank())
ggsave(plot = plot, file = "points_allowed_lose_pct.png")
ggsave(plot = plot, file = "points_allowed_lose_pct.png", width = 4, height = 3)
ggsave(plot = plot, file = "points_allowed_lose_pct.png", width = 5, height = 3)
ggsave(plot = plot, file = "points_allowed_lose_pct.png", width = 6, height = 3.5)
ggsave(plot = plot, file = "points_allowed_lose_pct.png", width = 6, height = 4)
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average"))
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_column_labels()
)
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(
style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))
)
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))) %>%
gtsave("everything_table.png")
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%")))
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
cell_text(weight = "bold"),
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))) %>%
gtsave("everything_table.png")
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
style = cell_text(weight = "bold"),
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))) %>%
gtsave("everything_table.png")
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))) %>%
gtsave("everything_table.png")
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cell_column_spanners()) %>%
gtsave("everything_table.png")
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_spanners()) %>%
gtsave("everything_table.png")
strategy_w_l %>%
left_join(strategy_points_allowed) %>%
left_join(strategy_avg_points) %>%
select(Strategy, Frequency, matches("point"), Average, `W/L`, `Win%`) %>%
gt(rowname_col = "Strategy") %>%
tab_header(title = md("**Fouling Up 3 is beneficial but uncommon**"),
subtitle = "Up by 3, Shot Clock off, at least 5 seconds remaining") %>%
cols_align(align = "center", columns = -"Strategy") %>%
tab_spanner(label = "Points Allowed",
columns = c(matches("point"), "Average")) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_labels(columns = c("Frequency", "W/L", "Win%"))) %>%
tab_style(style = cell_text(weight = "bold"),
locations = cells_column_spanners())
valid_poss %>%
filter(choice_foul == "Foul" & def_team_won == FALSE)
library(reactable)
valid_poss %>%
group_by(xid_possession) %>%
slice(1) %>%
ungroup() %>%
group_by(team_nba_def, choice_foul) %>%
count() %>%
pivot_wider(names_from = choice_foul, values_from = n) %>%
mutate_all(funs(replace(., is.na(.), 0))) %>%
mutate(opportunities = `Defend` + `Foul`) %>%
mutate(foul_rate = `Foul` / opportunities) %>%
select(-`Defend`, fouled = `Foul`) %>%
arrange(desc(foul_rate)) %>%
mutate(foul_rate = round(foul_rate, 2)) %>%
reactable(defaultSorted = list(foul_rate = "desc", opportunities = "asc"),
defaultColDef = colDef(vAlign = "center", headerVAlign = "bottom", align = "center"),
pagination = F,
highlight = T,
style = list(fontFamily = "Arial"),
columns =
list(
team_nba_def = colDef(name = "TEAM", filterable = T),
fouled = colDef(name = "FOUL STRATEGY"),
opportunities = colDef(name = "OPPORTUNITIES"),
foul_rate = colDef(name = "FOUL RATE")
))
